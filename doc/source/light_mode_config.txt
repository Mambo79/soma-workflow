
.. _light_mode_config:

=========================================
Light mode installation and configuration
=========================================

Soma-workflow can be launched as a simple one process application (without server). 
However, the light mode introduces some limitations compared to the 
client-server mode: 

* No remote access: The application must be run on a machine of the computing 
  resource (machine with a DRMS installed).

* No disconnection: The application can not be closed before all the
  running workflows and jobs ended.

If you are not interested in these two features the light mode is the mode 
you need.

Requirements
============

The requirements are identical to the server installation requirements (see :ref:`server_requirements`). 

.. note:: 
  If you don't intend to access an other computing resource with the 
  remote access feature, the installation of Pyro can be skipped.

Installation
============


1. *svn export/ cmake . / make / make install* (under construction)

2. Choose a resource identifier for the computing resource, ex: "My laptop light mode"

3. Create a configuration file (see :ref:`light_mode_configuration`) at the location $HOME/.soma-workflow.cfg. You can also choose your own path for the configuration file and set the "SOMA_WORKFLOW_CONFIG" environment variable with this path or put it in the /etc/ directory.  


.. _light_mode_configuration:

Configuration
=============

This section defines the required and optional configuration items for the light 
mode. 

The configuration file syntax is the `ConfigParser 
<http://docs.python.org/library/configparser.html>`_  syntax. All the 
configuration items needed are defined in one section. You can choose the 
section name, for example "My laptop light mode".

Configuration file example: ::

  [My laptop light mode]

  LIGHT_MODE    = True

  TRANSFERED_FILE_DIR = path/soma_workflow.db
  DATABASE_FILE       = path/transfered_files
  

If you want to use the same application as a client to other computing resources, 
make sure that Pyro was installed and add the configuration items required in the 
configuration file as described here: :ref:`client_configuration`.

Configuration file example: ::
 
  [My laptop light mode]

  LIGHT_MODE    = True

  TRANSFERED_FILE_DIR = path/soma_workflow.db
  DATABASE_FILE       = path/transfered_files
  
 
  [Titan]

  CLUSTER_ADDRESS     = titan.mylab.fr
  SUBMITTING_MACHINES = titan0
  
  QUEUES = test long 

  
  [LabDesktops]

  CLUSTER_ADDRESS     = mydesktop.mylab.fr
  SUBMITTING_MACHINES = mydesktop



Required configuration items
----------------------------

  **LIGHT_MODE**
    This item can be set up with any value, however it must be defined to use 
    soma_workflow in the light mode.
  
  **DATABASE_FILE**
    Path of the SQLite database file. The file will be created the first time 
    the application is launch.  

  **TRANSFERED_FILE_DIR**
    Path of the directory where the transfered files will be copied. The
    directory must be empty and will be managed entirely by soma-workflow.
    This item is required to let you run workflow with file transfer for 
    test purposes in the light mode. 

    .. warning::
      Do not copy any file in this directory. Soma_workflow manages the 
      entire directory and might delete any external file.

Optional configuration items
----------------------------

Many optional configuration item can be added to customize the installation, see
:ref:`server_configuration` for a full list of the items and their description.
  

 